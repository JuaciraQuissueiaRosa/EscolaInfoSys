@model IEnumerable<EscolaInfoSys.Models.ViewModels.AbsenceViewModel>


@{
    ViewData["Title"] = "My Absences";
}


@if (TempData["ExclusionAlert"] != null)
{
    <div class="alert alert-warning">
        @TempData["ExclusionAlert"]
    </div>
}


<h2 class="mb-4"><i class="fa fa-calendar-times me-2 text-danger"></i> My Absences</h2>

@if (!Model.Any())
{
    <div class="alert alert-success">No absences recorded. Keep up the good attendance!</div>
}
else
{
    <div id="AbsencesGrid"></div>
}

@section Scripts {
    <link href="https://cdn.syncfusion.com/ej2/30.1.47/material.css" rel="stylesheet" />
    <script src="https://cdn.syncfusion.com/ej2/30.1.47/dist/ej2.min.js"></script>

    <script>
        ej.base.enableRipple(true);

        var absencesData = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model));

        var grid = new ej.grids.Grid({
            dataSource: absencesData,
            allowPaging: true,
            allowSorting: true,
            columns: [
                { field: 'SubjectName', headerText: 'Subject', width: 150 },
                { field: 'Date', headerText: 'Date', type: 'date', format: 'dd/MM/yyyy', width: 150 },
                {
                    headerText: 'Justification',
                    template: function(data) {
                        return data.Justified ? 'Justified' : 'Unjustified';
                    },
                    width: 150
                }
            ],
            pageSettings: { pageSize: 10 }
        });
        grid.appendTo('#AbsencesGrid');
    </script>
}
